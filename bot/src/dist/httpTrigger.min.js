"use strict";var notificationTemplate=require("./adaptiveCards/notification-default.json"),_require=require("@microsoft/adaptivecards-tools"),AdaptiveCards=_require.AdaptiveCards,_require2=require("./internal/initialize"),bot=_require2.bot,_require3=require("@microsoft/teamsfx"),AppCredential=_require3.AppCredential,createMicrosoftGraphClientWithCredential=_require3.createMicrosoftGraphClientWithCredential;module.exports=function(t){var r,n,a,i,s,o,c,p,d,l;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(r=!0),a=void 0,e.prev=3,e.next=6,regeneratorRuntime.awrap(bot.notification.installations());case 6:e.t0=Symbol.iterator,i=e.sent[e.t0]();case 8:if(r=(s=i.next()).done){e.next=22;break}return o=s.value,c={authorityHost:process.env.M365_AUTHORITY_HOST,clientId:process.env.M365_CLIENT_ID,tenantId:process.env.M365_TENANT_ID,clientSecret:process.env.M365_CLIENT_SECRET},p=new AppCredential(c),d=createMicrosoftGraphClientWithCredential(p),l={"template@odata.bind":"https://graph.microsoft.com/v1.0/teamsTemplates('"+process.env.TEAMS_TEMPLATE_ID+"')",displayName:"My Incident A",description:"My Incident A description",members:[{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":"https://graph.microsoft.com/v1.0/users/"+process.env.MOD_ID}]},e.next=16,regeneratorRuntime.awrap(d.api("/teams").post(l));case 16:return e.sent,e.next=19,regeneratorRuntime.awrap(o.sendAdaptiveCard(AdaptiveCards.declare(notificationTemplate).render({title:"New Incident Occurred!",appName:"Disaster Tech",description:"Welcome to the new incident team. Here is the Incident Action Plan:  ".concat(o.type),notificationUrl:"https://m365x501367.sharepoint.com/sites/MyIncident4/Shared%20Documents/General/469308021927-5522126379-ticket.pdf"})));case 19:r=!0,e.next=8;break;case 22:e.next=28;break;case 24:e.prev=24,e.t1=e.catch(3),n=!0,a=e.t1;case 28:e.prev=28,e.prev=29,r||null==i.return||i.return();case 31:if(e.prev=31,n)throw a;e.next=34;break;case 34:return e.finish(31);case 35:return e.finish(28);case 36:t.res={};case 37:case"end":return e.stop()}},null,null,[[3,24,28,36],[29,,31,35]])};
//# sourceMappingURL=httpTrigger.min.js.map
